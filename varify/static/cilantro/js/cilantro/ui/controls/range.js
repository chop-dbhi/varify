define(["underscore","./base","../button","../../constants"],function(e,t,n,i){var o=t.Control.extend({template:"controls/range/layout",events:{"keyup .range-lower, .range-upper":"_change","change .btn-select":"_change","click .range-help-button":"toggleHelpText"},ui:{operatorSelect:".btn-select",lowerBound:".range-lower",upperBound:".range-upper",help:".help-block"},initialize:function(){this._change=e.debounce(this.change,i.INPUT_DELAY)},onRender:function(){this.operatorSelect=new n.ButtonSelect({collection:[{value:"range",label:"between",selected:!0},{value:"-range",label:"not between"}]}),this.operatorSelect.render().$el.prependTo(this.$el),this.ui.help.hide(),this.renderBounds(),this.listenTo(this.model.stats,"reset",this.renderBounds)},renderBounds:function(){this.readMinMaxStats(),e.isUndefined(this.minLowerBound)||this.setLowerBoundPlaceholder(this.minLowerBound),e.isUndefined(this.maxUpperBound)||this.setUpperBoundPlaceholder(this.maxUpperBound)},parseMinStat:function(e){return e},parseMaxStat:function(e){return e},readMinMaxStats:function(){var t=this.model.stats.get("min"),n=this.model.stats.get("max");e.isUndefined(t)||(this.minLowerBound=this.parseMinStat(t.get("value"))),e.isUndefined(n)||(this.maxUpperBound=this.parseMaxStat(n.get("value")))},toggleHelpText:function(e){e.preventDefault(),this.ui.help.toggle()},getField:function(){return this.model.id},getOperator:function(){var e=this.ui.lowerBound.val(),t=this.ui.upperBound.val(),n=this.operatorSelect.getSelection(),i="range"!==n;return n=""!==e&&""!==t?n:""!==e?i?"lte":"gte":""!==t?i?"gte":"lte":void 0},getLowerBoundValue:function(){return this.ui.lowerBound.val()},getUpperBoundValue:function(){return this.ui.upperBound.val()},exists:function(t){return e.exists(t)&&""!==t},getValue:function(){var e,t=this.getLowerBoundValue(),n=this.getUpperBoundValue();return this.exists(t)&&this.exists(n)?e=[t,n]:this.exists(t)?e=t:this.exists(n)&&(e=n),e},isFocused:function(e){return document.activeElement===e},setOperator:function(e){"-range"!==e&&(e="range"),this.operatorSelect.setSelection(e)},setLowerBoundPlaceholder:function(e){this.ui.lowerBound.prop("placeholder",e)},setLowerBoundValue:function(e){this.isFocused(this.ui.lowerBound[0])||this.ui.lowerBound.val(e)},setUpperBoundPlaceholder:function(e){this.ui.upperBound.prop("placeholder",e)},setUpperBoundValue:function(e){this.isFocused(this.ui.upperBound[0])||this.ui.upperBound.val(e)},set:function(t){if(!this._changing){this.setOperator(t.operator),this.setUpperBoundValue(),this.setLowerBoundValue();var n=t.value;e.isArray(n)?(e.isUndefined(n[0])||this.setLowerBoundValue(n[0]),e.isUndefined(n[1])||this.setUpperBoundValue(n[1])):e.isUndefined(n)||("gte"===t.operator?this.setLowerBoundValue(n):this.setUpperBoundValue(n))}},validate:function(t){return e.isUndefined(t.value)||e.isNull(t.value)?"A lower or upper value must be defined":e.isArray(t.value)&&t.value[0]>t.value[1]?"The lower bound cannot be greater than the upper":void 0}});return{RangeControl:o}});
//# sourceMappingURL=range.js.map