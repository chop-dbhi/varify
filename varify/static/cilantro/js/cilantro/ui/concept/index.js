define(["backbone","../core","../base","../accordion"],function(e,t,i,n){var o=n.AccordionItem.extend({events:{"click a":"click"},initialize:function(){this.listenTo(t,t.CONCEPT_FOCUS,this.toggleFocus)},click:function(e){e.preventDefault(),t.trigger(t.CONCEPT_FOCUS,this.model.id)},toggleFocus:function(e){this.$el.toggleClass("active",e===this.model.id)}}),r=n.AccordionSection.extend({itemView:o,filter:function(e,t){var i=!1;return this.children.each(function(n){!e||t[n.model.id]?(n.$el.show(),i=!0):n.$el.hide()}),this.$el.toggle(i),i}}),c=n.AccordionGroup.extend({itemView:r,filter:function(e,t){var i=!1;return this.children.each(function(n){n.filter(e,t)&&(i=!0)}),e?i?(this.$el.show(),this.expand()):this.$el.hide():(this.$el.show(),this.renderState()),i},find:function(e){var t,i,n;for(t in this.children._views)if(i=this.children._views[t],i.children&&(n=i.children.findByModel(e)))return n}}),s=n.Accordion.extend({className:"concept-index accordion",itemView:c,emptySearchView:i.EmptySearchView,showCollection:function(){this.resetGroups();var e=this;this.groups.each(function(t,i){e.addItemView(t,e.getItemView(t),i)})},getGroup:function(e){if(e.category){for(var t=e.category;t.parent;)t=t.parent;return t}return{id:-1,name:"Other"}},getSection:function(e){return e.category&&e.category.parent?e.category:{id:-1,name:"Other"}},resetGroups:function(){this.groups?this.groups.reset():this.groups=new e.Collection(null,{comparator:"order"});var t=this;this.collection.each(function(e){t.groupModel(e)})},groupModel:function(t){var i=this.getGroup(t.attributes),n=this.getSection(t.attributes),o=this.groups.get(i.id);o||(o=new e.Model(i),o.sections=new e.Collection(null,{comparator:"order"}),this.groups.add(o));var r=o.sections.get(n.id);r||(r=new e.Model(n),r.items=new e.Collection(null,{comparator:"order"}),o.sections.add(r)),r.items.add(t)},filter:function(e,t){var i={};if(e){var n,o,r;for(n=0;n<t.length;n++)o=t[n],(r=this.collection.get(o.id))&&(i[r.id]=r)}var c=!1;return this.children.each(function(t){t.filter(e,i)&&(c=!0)}),c?this.closeEmptySearchView():this.showEmptySearchView(e),c},find:function(e){var t,i,n;for(t in this.children._views)if(i=this.children._views[t],n=i.find(e))return n},showEmptySearchView:function(e){this.closeEmptySearchView(),this._emptyView=new this.emptySearchView({message:'<p>We could not find anything related to "'+e+'"</p>'}),this.$el.append(this._emptyView.render().el)},closeEmptySearchView:function(){this._emptyView&&(this._emptyView.remove(),delete this._emptyView)}});return{ConceptIndex:s,ConceptGroup:c,ConceptSection:r,ConceptItem:o}});
//# sourceMappingURL=index.js.map