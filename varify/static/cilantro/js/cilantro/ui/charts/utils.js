define(["underscore","highcharts"],function(t,e){var s=function(t){var s=e.getOptions().colors;return s[t%s.length]},r=function(t){var e=parseInt(t.substr(0,4)),s=parseInt(t.substr(5,2))-1,r=parseInt(t.substr(8,2));return Date.UTC(e,s,r)},a=function(t,a,i){if(a.length>2)throw new Error("3-dimensional charts are not supported.Specify which field the series applies to.");if(!a)throw new Error("The field instances must be supplied");var n,o,u,l,h,p,c,m=[],b=[],x=a[0],d=a[1];n=x.get("name"),o=x.get("enumerable")||"boolean"===x.get("simple_type"),u="date"===x.get("simple_type")?"datetime":"linear",d?(l=d.get("name"),h=d.get("enumerable")||"boolean"===d.get("simple_type"),p="date"===d.get("simple_type")?"datetime":"linear"):(l="Frequency",h=!1,p="linear"),o&&h?(c="scatter",m.push(" "),b.push(" ")):c=!d||o||h?h?"scatter":"column":"scatter";for(var g,y,f,v={},F=t.clustered,A=t.data,S=0;S<A.length;S++){g=A[S],y=i?g.values.slice(i,i+1)[0]:"",(f=v[y])?(f.data.push(g),f.stats.min=Math.min(f.stats.min,g.count),f.stats.max=Math.max(f.stats.max,g.count),f.stats.sum+=g.count):(f=v[y]={name:y,stats:{min:g.count,max:g.count,sum:g.count}},f.data=o&&h?[{x:0,y:0,radius:0,sentinel:!0},g]:[g]);var w=g.values[0];null===w&&(w="(no data)"),o?-1===m.indexOf(w.toString())&&(w=m.push(w.toString())-1):"datetime"===u&&(w=r(w));var I;d?(I=g.values[1],null===I&&(I="(no data)"),h?-1===b.indexOf(I.toString())&&(I=b.push(I.toString())-1):"datetime"===p&&(I=r(I))):I=g.count,g.x=w,g.y=I}var M,O,_=[];o&&h&&(M=m.push(" ")-1,O=b.push(" ")-1);var C=0;for(var T in v){f=v[T],o&&h&&(f.data.push({x:0,y:O,radius:0,sentinel:!0}),f.data.push({x:M,y:O,radius:0,sentinel:!0}),f.data.push({x:M,y:O,radius:0,sentinel:!0})),_.push(f);var k=f.stats.avg=f.stats.sum/parseFloat(f.data.length,10);if("scatter"===c)for(var S=0;S<f.data.length;S++){var E=f.data[S];if(!E.sentinel){var q=Math.min(Math.max(parseInt(parseFloat(E.count,10)/k*5)/10,.05),1),z=e.Color(s(C)).setOpacity(q);E.marker={fillColor:z.get()},o&&(E.marker.radius=7)}}C++}var B;B="scatter"===c&&o?_[1]?function(){return"<h5>"+this.series.name+"</h5><br /><b>"+n+":</b>"+this.series.xAxis.categories[this.point.x]+"<br /><b>"+l+":</b>"+this.series.yAxis.categories[this.point.y]}:function(){return"<b>"+n+":</b>"+this.series.xAxis.categories[this.point.x]+"<br /><b>"+l+":</b>"+this.series.yAxis.categories[this.point.y]}:"column"===c&&o?_[1]?function(){return"<h5>"+this.series.name+"</h5><br /><b>"+n+":</b>"+this.series.xAxis.categories[this.point.x]+"<br /><b>"+l+":</b>"+e.numberFormat(parseFloat(this.y))}:function(){return"<b>"+n+":</b>"+this.series.xAxis.categories[this.point.x]+"<br /><b>"+l+":</b>"+e.numberFormat(parseFloat(this.y))}:_[1]?function(){return"<h5>"+this.series.name+"</h5><br /><b>"+n+":</b>"+e.numberFormat(parseFloat(this.x))+"<br /><b>"+l+":</b>"+e.numberFormat(parseFloat(this.y))}:function(){return"<b>"+n+":</b>"+e.numberFormat(parseFloat(this.x))+"<br /><b>"+l+":</b>"+e.numberFormat(parseFloat(this.y))};var D={clustered:F,chart:{type:c},title:{text:d?""+n+" vs. "+l:""+n+" "+l},series:_,xAxis:{title:{text:n},type:u},yAxis:{title:{text:l},type:p},tooltip:{formatter:B}};return m.length&&(D.xAxis.categories=m),b.length&&(D.yAxis.categories=b),_[1]||(D.legend={enabled:!1}),"scatter"===c&&(D.yAxis.gridLineWidth=0,o||(D.chart.zoomType="xy")),D},i=function(e){for(var s,r,a=[],i=0;i<e.length;i++)r=e[i],s=t.clone(r),s.x=r.values[0],s.y=null!==r.values[1]?r.values[1]:r.count,a.push(s);return{data:t.sortBy(a,"x")}};return{processResponse:a,getSeries:i}});
//# sourceMappingURL=utils.js.map